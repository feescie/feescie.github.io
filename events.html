<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Events Gallery</title>
    <link rel="stylesheet" type="text/css" href="event.css">
</head>
<body>
    <header>
        <h1>Upcoming Events</h1>
    </header>   
    <main>
        <div id="event-list"></div>
    </main>

    <script>
        // Define your API key and calendar ID
        const apiKey = 'AIzaSyD4br-t_xdQt4JF3iyhuxs37CXeQ01He40';
        const calendarId = 'feestcie@vu-orkest.nl';

        // URL to fetch calendar events
        const url = `https://www.googleapis.com/calendar/v3/calendars/${calendarId}/events?key=${apiKey}`;

        // Fetch calendar events
        fetch(url)
            .then(response => response.json())
            .then(data => {
                const events = data.items;

                // Process and display the events
                const eventListContainer = document.getElementById("event-list");
                events.forEach(event => {
                    const summary = event.summary;
                    const start = event.start.dateTime;
                    const attachments = event.attachments;

                    // Create elements for the event
                    const eventItem = document.createElement("div");
                    eventItem.classList.add("event-container");
                    const eventTitle = document.createElement("h3");
                    eventTitle.classList.add("event-title");
                    const eventStartDate = document.createElement("p");
                    eventStartDate.classList.add("event-start-date");
                    const eventImage = document.createElement("img");
                    eventImage.classList.add("event-image");

                    // Set content for the elements
                    eventTitle.textContent = summary;
                    eventStartDate.textContent = ` Start: ${start}`;
                    
                    if (attachments && attachments.length > 0) {
                        // If there are attachments, check for images and display the first one
                        const imageAttachment = attachments.find(attachment => attachment.mimeType.startsWith('image/'));
                        if (imageAttachment) {
                            const match = imageAttachment.fileUrl.match(/id=([^&]+)/);
                            const imgID = match[1];
                            eventImage.src = `https://drive.google.com/uc?export=view&id=${imgID}`;
                            eventImage.alt = 'Event Image';
                            eventItem.appendChild(eventImage);
                        }
                    }

                    // Append elements to the event-list container
                    eventItem.appendChild(eventTitle);
                    eventItem.appendChild(eventStartDate);
                    eventListContainer.appendChild(eventItem);
                });
            })
            .catch(error => {
                console.error('Error fetching Google Calendar data: ', error);
            });
    </script>
</body>
</html>
